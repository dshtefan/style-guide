---
sidebar_position: 2
---

# CSRF –∑–∞—â–∏—Ç–∞

**CSRF (Cross-Site Request Forgery)** ‚Äî —ç—Ç–æ –∞—Ç–∞–∫–∞, –ø—Ä–∏ –∫–æ—Ç–æ—Ä–æ–π –∑–ª–æ—É–º—ã—à–ª–µ–Ω–Ω–∏–∫ –∑–∞—Å—Ç–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ–∂–µ–ª–∞—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —Å–∞–π—Ç–µ, –≥–¥–µ –æ–Ω –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω. –ü—Ä–∏–º–µ—Ä–æ–º –º–æ–∂–µ—Ç –±—ã—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–ª–∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–≥–æ POST-–∑–∞–ø—Ä–æ—Å–∞ –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

–≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏ –ø—Ä–∏–º–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–º–æ–≥—É—Ç –∑–∞—â–∏—Ç–∏—Ç—å –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ React –∏ TypeScript –æ—Ç –∞—Ç–∞–∫ CSRF.

---

### –û—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∑–∞—â–∏—Ç—ã –æ—Ç CSRF üîí

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CSRF-—Ç–æ–∫–µ–Ω–æ–≤**.
2. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞**.
3. **–ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –º–µ—Ç–æ–¥–æ–≤ HTTP**.
4. **–ó–∞–≥–æ–ª–æ–≤–∫–∏ CORS –∏ SameSite cookies**.

---

### –ß—Ç–æ —Ç–∞–∫–æ–µ CSRF-—Ç–æ–∫–µ–Ω? üéüÔ∏è

CSRF-—Ç–æ–∫–µ–Ω ‚Äî —ç—Ç–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π, –≤—Ä–µ–º–µ–Ω–Ω—ã–π –∫–ª—é—á, –∫–æ—Ç–æ—Ä—ã–π –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–µ —Å–µ—Ä–≤–µ—Ä–∞ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫ –∫–∞–∂–¥–æ–º—É –∑–∞—â–∏—â—ë–Ω–Ω–æ–º—É –∑–∞–ø—Ä–æ—Å—É. –°–µ—Ä–≤–µ—Ä –æ—Ç–∫–ª–æ–Ω—è–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞.

---

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CSRF-—Ç–æ–∫–µ–Ω–æ–≤

CSRF-—Ç–æ–∫–µ–Ω –æ–±—ã—á–Ω–æ –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–æ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∏–ª–∏ –≤–æ –≤—Ä–µ–º—è –≤—Ö–æ–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ï–≥–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–æ –≤—Å–µ–º POST, PUT, DELETE-–∑–∞–ø—Ä–æ—Å–∞–º.

**–ü—Ä–∏–º–µ—Ä: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CSRF-—Ç–æ–∫–µ–Ω–∞**

1. **–°—Ç–æ—Ä–æ–Ω–∞ —Å–µ—Ä–≤–µ—Ä–∞ (Node.js/Express):**
   –°–µ—Ä–≤–µ—Ä –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ç–æ–∫–µ–Ω –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –µ–≥–æ –≤ HTML-—Å—Ç—Ä–∞–Ω–∏—Ü—É –∏–ª–∏ –≤—ã–¥–∞—ë—Ç —á–µ—Ä–µ–∑ API.

```typescript
import csurf from "csurf";
import express from "express";

const app = express();
const csrfProtection = csurf({ cookie: true });

// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞
app.get("/form", csrfProtection, (req, res) => {
  res.cookie("XSRF-TOKEN", req.csrfToken()); // –ü–µ—Ä–µ–¥–∞—ë—Ç—Å—è –≤ cookie
  res.send({ csrfToken: req.csrfToken() }); // –ò–ª–∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ API
});
```

2. **–°—Ç–æ—Ä–æ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–∞ (React c fetch):**
   –ö–ª–∏–µ–Ω—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç CSRF-—Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞.

```typescript
const postData = async (endpoint: string, data: any) => {
  const csrfToken = document.cookie
    .split("; ")
    .find((row) => row.startsWith("XSRF-TOKEN="))?.split("=")[1];

  const response = await fetch(endpoint, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-CSRF-Token": csrfToken || "", // –ü–µ—Ä–µ–¥–∞—á–∞ —Ç–æ–∫–µ–Ω–∞ —Å –∑–∞–ø—Ä–æ—Å–æ–º
    },
    body: JSON.stringify(data),
  });

  return response.json();
};
```

**–ü–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:**
–ù–µ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å CSRF-—Ç–æ–∫–µ–Ω –≤ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö.

```typescript
// –ü–ª–æ—Ö–æ: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–æ–∫–µ–Ω–∞ –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å —É—è–∑–≤–∏–º—ã–º
fetch("/api/data", { method: "POST", body: JSON.stringify(data) });
```

---

### –í–∞–ª–∏–¥–∞—Ü–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Referer –∏–ª–∏ Origin –∑–∞–≥–æ–ª–æ–≤–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏, —á—Ç–æ –∑–∞–ø—Ä–æ—Å –ø—Ä–∏—à—ë–ª –∏–∑ –¥–æ–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –∏—Å—Ç–æ—á–Ω–∏–∫–∞.

**–ü—Ä–∏–º–µ—Ä: –ü—Ä–æ–≤–µ—Ä–∫–∞ Origin –∑–∞–≥–æ–ª–æ–≤–∫–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (Node.js):**
```typescript
app.use((req, res, next) => {
  const allowedOrigins = ["https://yourdomain.com"];
  const originHeader = req.headers.origin || req.headers.referer;

  if (originHeader && !allowedOrigins.some((origin) => originHeader.startsWith(origin))) {
    res.status(403).send("CSRF protection: Unauthorized origin");
  } else {
    next();
  }
});
```

**–ü–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:**
–ò–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞.

---

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CORS –∏ SameSite Cookies –¥–ª—è –∑–∞—â–∏—Ç—ã

CORS (Cross-Origin Resource Sharing) –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ `SameSite` –∞—Ç—Ä–∏–±—É—Ç–∞ —É cookies –¥–æ–±–∞–≤–ª—è—é—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å –∑–∞—â–∏—Ç—ã.

1. **CORS-–∑–∞–≥–æ–ª–æ–≤–∫–∏:**  
   –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞—à–∏ API-—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∑–∞–ø—Ä–æ—Å—ã —Ç–æ–ª—å–∫–æ —Å –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –¥–æ–º–µ–Ω–æ–≤.

**–ü—Ä–∏–º–µ—Ä –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ CORS:**
```typescript
import cors from "cors";

app.use(cors({
  origin: "https://yourdomain.com", // –î–æ–≤–µ—Ä–µ–Ω–Ω—ã–π –¥–æ–º–µ–Ω
  credentials: true, // –ü–µ—Ä–µ–¥–∞—á–∞ cookies
}));
```

2. **SameSite Cookies:**  
   –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∞—Ç—Ä–∏–±—É—Ç—ã `SameSite` –∏ `Secure`, —á—Ç–æ–±—ã –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ cookies.

**–ü—Ä–∏–º–µ—Ä: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ cookies —Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏ (Node.js):**
```typescript
res.cookie("SESSION_ID", "secure_session_id", {
  httpOnly: true,
  secure: true, // –¢–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ HTTPS
  sameSite: "Strict", // Cookie –¥–æ—Å—Ç—É–ø–Ω—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ —Å —Ç–æ–≥–æ –∂–µ —Å–∞–π—Ç–∞
});
```

**–ü–ª–æ—Ö–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:**
- –û—Ç–∫—Ä—ã—Ç–æ–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ CORS-–Ω–∞—Å—Ç—Ä–æ–µ–∫ (`*` –≤ `origin`).
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ `SameSite` –∏–ª–∏ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –µ–≥–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è.

---

### –ú–µ—Ä—ã –ø—Ä–µ–¥–æ—Å—Ç–æ—Ä–æ–∂–Ω–æ—Å—Ç–∏ –¥–ª—è –º–µ—Ç–æ–¥–æ–≤ HTTP

CSRF-–∞—Ç–∞–∫–∏ –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç GET-–∑–∞–ø—Ä–æ—Å—ã, —Ç–∞–∫ –∫–∞–∫ –±—Ä–∞—É–∑–µ—Ä—ã –º–æ–≥—É—Ç –∏—Ö –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –Ω–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏–π —Å–∞–π—Ç –±–µ–∑ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö) –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –±–µ–∑–æ–ø–∞—Å–Ω—ã–µ –º–µ—Ç–æ–¥—ã (POST, PUT, DELETE).

**–ü—Ä–∏–º–µ—Ä: –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è GET-–∑–∞–ø—Ä–æ—Å–æ–≤**
```typescript
app.get("/delete-user", (req, res) => {
  res.status(405).send("GET method not allowed for this action");
});
```

**–•–æ—Ä–æ—à–∞—è –ø—Ä–∞–∫—Ç–∏–∫–∞:**
–î–ª—è –æ–ø–∞—Å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Ç—Ä–µ–±—É–π—Ç–µ POST-–∑–∞–ø—Ä–æ—Å —Å CSRF-—Ç–æ–∫–µ–Ω–æ–º –∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π.

---

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å CSRF –≤ React

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏–ª–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è CSRF-—Ç–æ–∫–µ–Ω–æ–≤.**  
   –ù–∞–ø—Ä–∏–º–µ—Ä, –¥–æ–±–∞–≤—å—Ç–µ CSRF-—Ç–æ–∫–µ–Ω –≤ `React Context` –∏ –ø–æ–¥–∫–ª—é—á–∞–π—Ç–µ –µ–≥–æ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö.

2. **–ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (LocalStorage –∏–ª–∏ SessionStorage).**  
   –•—Ä–∞–Ω–∏—Ç–µ –∏—Ö –≤ `HttpOnly cookies`, —á—Ç–æ–±—ã –∏—Ö –Ω–µ–ª—å–∑—è –±—ã–ª–æ –ø—Ä–æ—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ JavaScript.

3. **–û–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏ –∫–∞–∂–¥–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å–µ—Å—Å–∏–∏.**  
   –°—Ç–∞—Ä—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–æ–ª–∂–Ω—ã —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –Ω–µ–¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–º–∏.

---

### –í—ã–≤–æ–¥—ã üìå

1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ CSRF-—Ç–æ–∫–µ–Ω—ã –¥–ª—è –≤—Å–µ—Ö POST, PUT, DELETE-–∑–∞–ø—Ä–æ—Å–æ–≤.  
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ Referer –∏ Origin –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –∏—Å—Ç–æ—á–Ω–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–∞.  
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ CORS-–∑–∞–≥–æ–ª–æ–≤–∫–∏ –∏ `SameSite Cookies` –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –¥–æ–º–µ–Ω–æ–≤.  
4. ‚úÖ –ò–∑–±–µ–≥–∞–π—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è GET-–∑–∞–ø—Ä–æ—Å–æ–≤ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤–∞–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π.  
5. ‚úÖ –°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö –º–µ—Å—Ç–∞—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ cookies —Å —Ñ–ª–∞–≥–æ–º HttpOnly.