---
sidebar_position: 2
---

# –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤

–¢–æ–∫–µ–Ω—ã (–Ω–∞–ø—Ä–∏–º–µ—Ä, JWT) –∏–≥—Ä–∞—é—Ç –∫–ª—é—á–µ–≤—É—é —Ä–æ–ª—å –≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —É—Ç–µ—á–∫–µ –¥–∞–Ω–Ω—ã—Ö –∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ —Ü–µ–ª–æ–º. –í —ç—Ç–æ–º —Ä–∞–∑–¥–µ–ª–µ –º—ã —Ä–∞–∑–±–µ—Ä–µ–º –ª—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –≤ React-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **RTK Query**.

---

### üîë –û—Å–Ω–æ–≤–Ω—ã–µ –ø–æ–¥—Ö–æ–¥—ã –∫ —Ä–∞–±–æ—Ç–µ —Å —Ç–æ–∫–µ–Ω–∞–º–∏

1. **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–µ—Å—Ç–æ —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤:**
   - **Local Storage**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –∏—Å—Ç–µ–∫–∞—é—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ —Å–ª—É—á–∞–µ "Remember Me"). –û–¥–Ω–∞–∫–æ —ç—Ç–æ –Ω–µ —Å–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥, —Ç–∞–∫ –∫–∞–∫ –¥–∞–Ω–Ω—ã–µ –º–æ–≥—É—Ç –±—ã—Ç—å —É—è–∑–≤–∏–º—ã –¥–ª—è XSS-–∞—Ç–∞–∫.
   - **Session Storage**: –ë–æ–ª—å—à–µ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π, —Ç–æ–∫–µ–Ω —Å—Ç–∏—Ä–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–∫–∏. –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —É—è–∑–≤–∏–º –¥–ª—è XSS.
   - **HttpOnly Cookies**: –°–∞–º—ã–π –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Å–ø–æ—Å–æ–±, —Ç–∞–∫ –∫–∞–∫ cookie –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞ –∏–∑ JavaScript, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–µ—Ä–≤–µ—Ä–∞.

2. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤:**
   - –î–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **refresh-—Ç–æ–∫–µ–Ω—ã** —Å –∏—Ö –±–µ–∑–æ–ø–∞—Å–Ω—ã–º —Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–æ–∫–µ–Ω–∞ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥:**
   - –ò–Ω—Ç–µ—Ä—Å–µ–ø—Ç–æ—Ä—ã –≤ RTK Query –ø–æ–∑–≤–æ–ª—è—é—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –∏—Ö –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

---

### üìñ –ü—Ä–∏–º–µ—Ä —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Å RTK Query

#### 1Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API-—Å–µ—Ä–≤–∏—Å–∞ —Å —Ç–æ–∫–µ–Ω–æ–º

–î–ª—è –Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–¥–∏–º API-—Å–µ—Ä–≤–∏—Å, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ç–æ–∫–µ–Ω–∞–º–∏. –í —Å–ª—É—á–∞–µ —É—Å—Ç–∞—Ä–µ–≤—à–µ–≥–æ —Ç–æ–∫–µ–Ω–∞ –º—ã –Ω–∞—Å—Ç—Ä–æ–∏–º –µ–≥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.

```tsx
// services/authApi.ts
import { createApi, fetchBaseQuery } from "@reduxjs/toolkit/query/react";

// –¢–∏–ø–∏–∑–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
interface AuthToken {
  accessToken: string;
  refreshToken: string;
}

// –°–æ–∑–¥–∞–µ–º API-—Å–µ—Ä–≤–∏—Å –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
export const authApi = createApi({
  reducerPath: "authApi",
  baseQuery: fetchBaseQuery({
    baseUrl: "https://example.com/api",
    prepareHeaders: (headers, { getState }) => {
      const token = (getState() as RootState).auth.accessToken;
      if (token) {
        headers.set("Authorization", `Bearer ${token}`); // –î–æ–±–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
      }
      return headers;
    },
  }),
  endpoints: (builder) => ({
    login: builder.mutation<AuthToken, { username: string; password: string }>({
      query: (credentials) => ({
        url: "auth/login",
        method: "POST",
        body: credentials,
      }),
      // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ª–æ–≥–∏–Ω–∞
      transformResponse: (response: AuthToken) => response,
    }),
    refreshToken: builder.mutation<AuthToken, { refreshToken: string }>({
      query: (body) => ({
        url: "auth/refresh",
        method: "POST",
        body,
      }),
    }),
  }),
});

export const { useLoginMutation, useRefreshTokenMutation } = authApi;
```

---

#### 2Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Redux Slice –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

–°–æ–∑–¥–∞–µ–º –æ—Ç–¥–µ–ª—å–Ω—ã–π slice –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–∞–º–∏ –∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

```tsx
// features/auth/authSlice.ts
import { createSlice, PayloadAction } from "@reduxjs/toolkit";
import { AuthToken } from "../../services/authApi";

interface AuthState {
  accessToken: string | null;
  refreshToken: string | null;
}

const initialState: AuthState = {
  accessToken: null,
  refreshToken: null,
};

const authSlice = createSlice({
  name: "auth",
  initialState,
  reducers: {
    setTokens(state, action: PayloadAction<AuthToken>) {
      state.accessToken = action.payload.accessToken;
      state.refreshToken = action.payload.refreshToken;
    },
    clearTokens(state) {
      state.accessToken = null;
      state.refreshToken = null;
    },
  },
});

export const { setTokens, clearTokens } = authSlice.actions;
export default authSlice.reducer;
```

---

#### 3Ô∏è‚É£ –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –ª–æ–≥–∏–Ω–∞

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –≤—Ö–æ–¥–∞ –≤ —Å–∏—Å—Ç–µ–º—É, –≥–¥–µ –º—ã —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞.

```tsx
// components/LoginForm.tsx
import React, { useState } from "react";
import { useLoginMutation } from "../services/authApi";
import { useDispatch } from "react-redux";
import { setTokens } from "../features/auth/authSlice";

const LoginForm: React.FC = () => {
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const [login, { isLoading, isError }] = useLoginMutation();
  const dispatch = useDispatch();

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    try {
      const tokens = await login({ username, password }).unwrap();
      dispatch(setTokens(tokens)); // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–æ–∫–µ–Ω—ã –≤ Redux
    } catch (error) {
      console.error("Login failed:", error);
    }
  };

  return (
    <form onSubmit={handleSubmit}>
      <input
        type="text"
        placeholder="Username"
        value={username}
        onChange={(e) => setUsername(e.target.value)}
      />
      <input
        type="password"
        placeholder="Password"
        value={password}
        onChange={(e) => setPassword(e.target.value)}
      />
      <button type="submit" disabled={isLoading}>
        {isLoading ? "Logging in..." : "Login"}
      </button>
      {isError && <p>Login failed. Please try again.</p>}
    </form>
  );
};

export default LoginForm;
```

---

#### 4Ô∏è‚É£ –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ –∏—Ö –∏—Å—Ç–µ—á–µ–Ω–∏–∏

–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–µ—Ä–µ—Ö–≤–∞—Ç—á–∏–∫–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤.

```tsx
// services/authApi.ts (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ baseQuery)
baseQuery: fetchBaseQuery({
  baseUrl: "https://example.com/api",
  prepareHeaders: (headers, { getState }) => {
    const token = (getState() as RootState).auth.accessToken;
    if (token) {
      headers.set("Authorization", `Bearer ${token}`);
    }
    return headers;
  },
  onError: async (error, { dispatch, getState }) => {
    if (error?.status === 401) {
      const refreshToken = (getState() as RootState).auth.refreshToken;
      if (refreshToken) {
        const newTokens = await dispatch(
          useRefreshTokenMutation({ refreshToken })
        ).unwrap();
        dispatch(setTokens(newTokens)); // –û–±–Ω–æ–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω—ã
      } else {
        dispatch(clearTokens());
      }
    }
  },
}),
```

---

### ‚úÖ –ü—Ä–∏–º–µ—Ä —Ö–æ—Ä–æ—à–µ–π –ø—Ä–∞–∫—Ç–∏–∫–∏

1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **RTK Query** —É–±–∏—Ä–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤—Ä—É—á–Ω—É—é –ø—Ä–æ–±—Ä–∞—Å—ã–≤–∞—Ç—å —Ç–æ–∫–µ–Ω—ã –≤ –∑–∞–ø—Ä–æ—Å—ã.
2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∫–æ–≥–¥–∞ —Ç–æ–∫–µ–Ω —É—Å—Ç–∞—Ä–µ–≤–∞–µ—Ç.
3. –¢–æ–∫–µ–Ω—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ Redux (–∏–ª–∏ –≤ secure cookies/localStorage, –µ—Å–ª–∏ —Ç–∞–∫ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–µ–∫—Ç).

---

### ‚ùå –ü—Ä–∏–º–µ—Ä –ø–ª–æ—Ö–æ–π –ø—Ä–∞–∫—Ç–∏–∫–∏

```tsx
const sendRequest = async () => {
  const token = localStorage.getItem("accessToken");
  const response = await fetch("https://example.com/api/data", {
    method: "GET",
    headers: {
      Authorization: `Bearer ${token}`,
    },
  });

  if (response.status === 401) {
    const refreshToken = localStorage.getItem("refreshToken");
    const refreshResp = await fetch("https://example.com/api/auth/refresh", {
      method: "POST",
      body: JSON.stringify({ refreshToken }),
    });
    const newTokens = await refreshResp.json();
    localStorage.setItem("accessToken", newTokens.accessToken);
    localStorage.setItem("refreshToken", newTokens.refreshToken);
  }
};
```

**–ü–æ—á–µ–º—É —ç—Ç–æ –ø–ª–æ—Ö–æ:**
1. ‚ùå –õ–æ–≥–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–æ–∫–µ–Ω–æ–≤ —Ä–∞–∑–±–∏—Ç–∞ –ø–æ –∫–æ–¥—É –Ω–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤.
2. ‚ùå –®–∏—Ä–æ–∫–æ–µ –∑–∞–∏–º—Å—Ç–≤–æ–≤–∞–Ω–∏–µ localStorage –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.
3. ‚ùå –ù–µ—Ç —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ —Ç–æ–∫–µ–Ω–æ–≤.

---

### üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ RTK Query**: –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –∏ –∑–∞–ø—Ä–æ—Å—ã.
2. **–•—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ Redux, Secure Cookies –∏–ª–∏ Session Storage.**
3. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã —á–µ—Ä–µ–∑ refresh-token API.**
4. –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –æ—à–∏–±–∫–∏, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ `onError` RTK Query).

---

### üéØ –í—ã–≤–æ–¥—ã:

- RTK Query –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–±—Ä–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å —Ç–æ–∫–µ–Ω–∞–º–∏ –≤ –µ–¥–∏–Ω–æ–º API-—Å–µ—Ä–≤–∏—Å–µ.
- –õ–æ–≥–∏–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –≥–æ—Ä–∞–∑–¥–æ –ø—Ä–æ—â–µ, –±–ª–∞–≥–æ–¥–∞—Ä—è —Ö—É–∫–∞–º `useLoginMutation`, `useRefreshTokenMutation`.
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∞—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–∏—Ç—å—Å—è –Ω–∞ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–µ, –∞ –Ω–µ –ø–æ–≤—Ç–æ—Ä—è—é—â–µ–º—Å—è –∫–æ–¥–µ.